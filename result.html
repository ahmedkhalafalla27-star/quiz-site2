<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8">
<title>Ù†ØªÙŠØ¬ØªÙƒ</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<link rel="stylesheet" href="style.css">
</head>

<body>

<main class="centered">
  <div class="card result-card" id="resultCard">
    Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù†ØªÙŠØ¬Ø©...
  </div>
</main>

<script>
/* ========= Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª ========= */
const testsMeta = {
  iq: "ğŸ§  Ø§Ø®ØªØ¨Ø§Ø± Ø°ÙƒØ§Ø¡",
  analytical_thinking: "ğŸ§  Ø§Ù„ØªÙÙƒÙŠØ± Ø§Ù„ØªØ­Ù„ÙŠÙ„ÙŠ",
  iq_speed: "âš¡ Ø³Ø±Ø¹Ø© Ø¨Ø¯ÙŠÙ‡Ø©",
  math_logic_iq: "ğŸ§® Ø°ÙƒØ§Ø¡ Ù…Ù†Ø·Ù‚ÙŠ",
  football: "âš½ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª ÙƒØ±ÙˆÙŠØ©",
  football_ahly_zamalek: "ğŸ”¥ Ø§Ù„Ø£Ù‡Ù„ÙŠ Ã— Ø§Ù„Ø²Ù…Ø§Ù„Ùƒ",
  fun_general_knowledge: "ğŸŒ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¹Ø§Ù…Ø©",
  geo: "ğŸ—ºï¸ Ø¬ØºØ±Ø§ÙÙŠØ§",
  personality: "ğŸ‘¤ Ø§Ø®ØªØ¨Ø§Ø± Ø´Ø®ØµÙŠØ©",
  decision_personality: "ğŸ‘¥ Ù‚Ø±Ø§Ø±Ø§Øª Ø´Ø®ØµÙŠØ©",
  quran_hifz: "ğŸ“– Ø­ÙØ¸ Ø§Ù„Ù‚Ø±Ø¢Ù†"
};

function analyze(percent){
  if(percent >= 90) return "Ù…Ù…ØªØ§Ø² Ø¬Ø¯Ù‹Ø§";
  if(percent >= 75) return "Ù‚ÙˆÙŠ";
  if(percent >= 60) return "Ø¬ÙŠØ¯";
  if(percent >= 40) return "Ù…ØªÙˆØ³Ø·";
  return "Ø¨Ø­Ø§Ø¬Ø© ØªØ·ÙˆÙŠØ±";
}

/* ========= Ù…ØªØºÙŠØ±Ø§Øª Global Ù„Ù„Ù…Ø´Ø§Ø±ÙƒØ© ========= */
let SHARE_TEXT = "";
let SHARE_URL = "";

/* ========= ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù†ØªÙŠØ¬Ø© ========= */
(function(){
  const params = new URLSearchParams(location.search);
  const test = params.get("test");
  const raw = localStorage.getItem(`result_${test}`);

  if(!raw){
    document.getElementById("resultCard").innerHTML = "Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªÙŠØ¬Ø© Ù…Ø­ÙÙˆØ¸Ø©";
    return;
  }

  const result = JSON.parse(raw);
  const percent = Math.round(result.score / result.total * 100);
  const analysis = analyze(percent);
  const title = testsMeta[test] || "Ø§Ø®ØªØ¨Ø± Ù‚Ø¯Ø±Ø§ØªÙƒ";

  SHARE_TEXT = `${title}
Ù†ØªÙŠØ¬ØªÙŠ: ${percent}%
Ø§Ù„ØªÙ‚ÙŠÙŠÙ…: ${analysis}
Ø§Ø®ØªØ¨Ø± Ù†ÙØ³Ùƒ Ø§Ù„Ø¢Ù† ğŸ‘‡`;

  SHARE_URL = location.origin + "/index.html";

  document.getElementById("resultCard").innerHTML = `
    <h2>${title}</h2>
    <p>ğŸ“Š Ø§Ù„Ù†ØªÙŠØ¬Ø©: <strong>${percent}%</strong></p>
    <p>ğŸ§  Ø§Ù„ØªÙ‚ÙŠÙŠÙ…: <strong>${analysis}</strong></p>

    <div class="ad-slot">Ù…ÙƒØ§Ù† Ø¥Ø¹Ù„Ø§Ù†</div>

    <button class="btn primary" onclick="shareFacebook()">
      ğŸ“¤ Ù…Ø´Ø§Ø±ÙƒØ© Ø¹Ù„Ù‰ ÙÙŠØ³Ø¨ÙˆÙƒ
    </button>

    <br><br>
    <a href="index.html" class="btn secondary">Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø£Ø®Ø±Ù‰</a>
  `;
})();

/* ========= Ø¯Ø§Ù„Ø© Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© (GLOBAL) ========= */
function shareFacebook(){
  const url = encodeURIComponent(SHARE_URL);
  const text = encodeURIComponent(SHARE_TEXT);

  // Ù…Ø­Ø§ÙˆÙ„Ø© ÙØªØ­ ØªØ·Ø¨ÙŠÙ‚ ÙÙŠØ³Ø¨ÙˆÙƒ
  const appLink = `fb://facewebmodal/f?href=https://www.facebook.com/sharer/sharer.php?u=${url}&quote=${text}`;
  const webLink = `https://www.facebook.com/sharer/sharer.php?u=${url}&quote=${text}`;

  window.location.href = appLink;

  // Ù„Ùˆ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ù…Ø´ Ù…ÙˆØ¬ÙˆØ¯
  setTimeout(() => {
    window.open(webLink, "_blank");
  }, 1200);
}
</script>

</body>
</html>
