<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8">
<title>Ù†ØªÙŠØ¬ØªÙƒ</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<link rel="stylesheet" href="style.css">
</head>

<body>

<main class="centered">
  <div class="card result-card" id="resultCard">
    Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù†ØªÙŠØ¬Ø©...
  </div>
</main>

<script>
const testsMeta = {
  iq: "ğŸ§  Ø§Ø®ØªØ¨Ø§Ø± Ø°ÙƒØ§Ø¡",
  analytical_thinking: "ğŸ§  Ø§Ù„ØªÙÙƒÙŠØ± Ø§Ù„ØªØ­Ù„ÙŠÙ„ÙŠ",
  iq_speed: "âš¡ Ø³Ø±Ø¹Ø© Ø¨Ø¯ÙŠÙ‡Ø©",
  math_logic_iq: "ğŸ§® Ø°ÙƒØ§Ø¡ Ù…Ù†Ø·Ù‚ÙŠ",
  football: "âš½ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª ÙƒØ±ÙˆÙŠØ©",
  football_ahly_zamalek: "ğŸ”¥ Ø§Ù„Ø£Ù‡Ù„ÙŠ Ã— Ø§Ù„Ø²Ù…Ø§Ù„Ùƒ",
  fun_general_knowledge: "ğŸŒ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¹Ø§Ù…Ø©",
  geo: "ğŸ—ºï¸ Ø¬ØºØ±Ø§ÙÙŠØ§",
  personality: "ğŸ‘¤ Ø§Ø®ØªØ¨Ø§Ø± Ø´Ø®ØµÙŠØ©",
  decision_personality: "ğŸ‘¥ Ù‚Ø±Ø§Ø±Ø§Øª Ø´Ø®ØµÙŠØ©",
  quran_hifz: "ğŸ“– Ø­ÙØ¸ Ø§Ù„Ù‚Ø±Ø¢Ù†"
};

function analyze(percent){
  if(percent >= 90) return "Ù…Ù…ØªØ§Ø² Ø¬Ø¯Ù‹Ø§";
  if(percent >= 75) return "Ù‚ÙˆÙŠ";
  if(percent >= 60) return "Ø¬ÙŠØ¯";
  if(percent >= 40) return "Ù…ØªÙˆØ³Ø·";
  return "Ø¨Ø­Ø§Ø¬Ø© ØªØ·ÙˆÙŠØ±";
}

const params = new URLSearchParams(location.search);
const test = params.get("test");
const raw = localStorage.getItem(`result_${test}`);

if(!raw){
  document.getElementById("resultCard").innerHTML = "Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªÙŠØ¬Ø©";
  throw "";
}

const result = JSON.parse(raw);
const percent = Math.round(result.score / result.total * 100);
const analysis = analyze(percent);
const title = testsMeta[test] || "Ø§Ø®ØªØ¨Ø± Ù‚Ø¯Ø±Ø§ØªÙƒ";

const shareText = `${title}
Ù†ØªÙŠØ¬ØªÙŠ: ${percent}%
Ø§Ù„ØªÙ‚ÙŠÙŠÙ…: ${analysis}
Ø§Ø®ØªØ¨Ø± Ù†ÙØ³Ùƒ Ø§Ù„Ø¢Ù† ğŸ‘‡`;

const shareURL = location.origin + "/index.html";

document.getElementById("resultCard").innerHTML = `
  <h2>${title}</h2>
  <p>ğŸ“Š Ù†ØªÙŠØ¬ØªÙƒ: <strong>${percent}%</strong></p>
  <p>ğŸ§  Ø§Ù„ØªÙ‚ÙŠÙŠÙ…: <strong>${analysis}</strong></p>

  <div class="ad-slot">Ù…ÙƒØ§Ù† Ø¥Ø¹Ù„Ø§Ù†</div>

  <button class="btn primary" id="shareBtn">
    ğŸ“¤ Ù…Ø´Ø§Ø±ÙƒØ© Ø¹Ù„Ù‰ ÙÙŠØ³Ø¨ÙˆÙƒ
  </button>

  <br><br>
  <a href="index.html" class="btn secondary">Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø£Ø®Ø±Ù‰</a>
`;

/* ========= Ø±Ø¨Ø· Ø§Ù„Ø²Ø± ========= */
document.getElementById("shareBtn").addEventListener("click", function () {
  const url = encodeURIComponent(shareURL);
  const text = encodeURIComponent(shareText);

  const fbShare = `https://www.facebook.com/sharer/sharer.php?u=${url}&quote=${text}`;

  window.open(fbShare, "_blank");
});
</script>

</body>
</html>
